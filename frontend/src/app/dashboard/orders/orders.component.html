<mat-tab-group animationDuration="0ms">
    <mat-tab label="Active orders">

        <h2 class="header_title">Orders
            <span *ngIf="countBookings > 0">({{ countBookings }})</span>
        </h2>

        <div *ngIf="showSpinner" class="spinner_align_center">
            <mat-spinner strokeWidth="4" diameter="30" class="blue_spinner"></mat-spinner>
        </div>

        <div *ngIf="countBookings == 0 && (bookings$ | async | filterByStatus: 'active').length == 0
                || countBookings > 0 && (bookings$ | async | filterByStatus: 'active').length == 0">
                No active orders yet.
            </div>
            <div *ngFor="let state of ['confirmCancel','active']; 
            trackBy: trackById" 
            class="{{ state }}">
            <div *ngFor="let order of bookings$ 
            | async 
            | filterByStatus: state 
            | reverse; 
            trackBy: trackById;
            let i = index" 
            class="room_container">
                <app-active
                    [order]="order"
                    [state]="state"
                    [role]="role"
                    [ngClass]="{ 'new' : newOrdersId.includes(order._id) }">
                    <button *ngIf="state == 'active' && role == 'user'"
                        (click)="changeOrderStatus(order._id,'confirmCancel')"
                        class="btn btn-grey-outline w_100">
                        Cancel
                    </button>
                    <button *ngIf="state == 'active' && role == 'member' || state == 'active' && role == 'admin'"
                        (click)="changeOrderStatus(order._id,'completed')" class="btn btn-orange w_100">
                        Complete order
                    </button>
                    <button *ngIf="state == 'confirmCancel' && role != 'user'" (click)="changeOrderStatus(order._id,'canceled')"
                        class="btn btn-blue w_100">
                        Cancel order
                    </button>{{state}}
                </app-active>
                
            </div>
        </div>
    </mat-tab>

    <mat-tab label="Completed">
        <div *ngIf="(bookings$ | async | filterByStatus: 'completed')?.length == 0">
            No completed orders yet.
        </div>

        <div class="items_container"> <div *ngFor="let order of bookings$ | async | filterByStatus: 'completed'; trackBy: trackById" 
                class="order" [ngClass]="{ 'column' : role == 'user' }">
                <div class="d_flex w_100">
                    <app-completed
                        [order]="order"
                        [state]="'completed'"
                        [role]="role">
                        <button 
                            *ngIf="role == 'user'" 
                            class="btn btn-grey-outline w_100" 
                            (click)="changeOrderStatus(order._id,'active')">
                            Reopen
                        </button>
                    </app-completed>
                </div>
            </div>
        </div>
    </mat-tab>

    <mat-tab label="Canceled">
        <div *ngIf="(bookings$ | async | filterByStatus: 'canceled').length == 0">
            No canceled orders yet.
        </div>

        <div class="items_container">
            <div *ngFor="let order of bookings$ | async | filterByStatus: 'canceled' | reverse; trackBy: trackById" class="order" [ngClass]="{ 'column' : role == 'user' }">
                <div class="d_flex w_100">
                    <div class="d_flex justify_content_between w_100">
                        <app-canceled
                            [order]="order"
                            [state]="'canceled'"
                            [role]="role">
                            <button 
                                *ngIf="role == 'user'" 
                                class="btn btn-grey-outline w_100" 
                                (click)="changeOrderStatus(order._id,'active')">
                                Reopen
                            </button>
                        </app-canceled>
                    </div>
                </div>
            </div>
        </div>

    </mat-tab>
</mat-tab-group>